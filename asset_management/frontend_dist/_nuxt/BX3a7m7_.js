import{_ as E,x as Z,l as J,A as U,r as d,p as K,c as l,o,a as t,d as O,q as W,h as g,y as j,i,v as k,D as A,G as D,F as h,C as w,t as v}from"./BwLa1Iej.js";import{a as _}from"./bE3RgOHv.js";import{S as I}from"./BQxta0Da.js";import{u as X}from"./DBTBYWdU.js";const Y={class:"container mx-auto px-4 py-5",dir:"rtl"},ee={class:"flex justify-between items-center mb-6 max-w-7xl mx-auto px-2"},te={key:0,class:"text-center py-10"},re={key:1,class:"max-w-7xl mx-auto"},ae={class:"flex gap-2 mb-6 px-2 border-b border-gray-200 dark:border-gray-700 overflow-x-auto"},se={key:0,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 md:p-8"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},oe={class:"flex items-end gap-2"},de={class:"flex-1"},ne={class:"flex gap-4 mt-2"},ie={class:"flex items-center gap-2 cursor-pointer"},ue={class:"flex items-center gap-2 cursor-pointer"},be={key:1,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 md:p-8"},ge={class:"max-w-md"},ve=["value"],ce={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},xe={class:"bg-white/90 backdrop-blur-sm border border-gray-200 rounded-2xl shadow-lg h-full dark:bg-gray-800/90 dark:border-gray-700"},ye={class:"p-4"},ke={class:"relative mb-4"},pe={class:"max-h-[480px] overflow-y-auto"},me={class:"space-y-3"},fe={class:"font-medium text-gray-800 dark:text-gray-200"},he=["onClick"],we={key:0,class:"text-center py-6 text-gray-500 text-sm dark:text-gray-400"},_e={class:"bg-white/90 backdrop-blur-sm border border-gray-200 rounded-2xl shadow-lg h-full dark:bg-gray-800/90 dark:border-gray-700"},Ce={class:"p-4 max-h-[480px] overflow-y-auto"},Le={class:"space-y-3"},Ve={class:"font-bold text-gray-800 dark:text-gray-200"},je=["onClick"],$e={key:0,class:"text-center py-6 text-gray-500 text-sm dark:text-gray-400"},Ue={key:3,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ie={class:"bg-white/90 backdrop-blur-sm border border-gray-200 rounded-2xl shadow-lg h-full dark:bg-gray-800/90 dark:border-gray-700"},Me={class:"p-4"},Be={class:"relative mb-4"},Ge={class:"max-h-[480px] overflow-y-auto"},Pe={class:"space-y-3"},Re={class:"flex flex-col"},Se={class:"font-medium text-gray-800 dark:text-gray-200"},Ae={class:"text-xs text-gray-500 dark:text-gray-400"},De=["onClick"],Te={key:0,class:"text-center py-6 text-gray-500 text-sm dark:text-gray-400"},qe={class:"bg-white/90 backdrop-blur-sm border border-gray-200 rounded-2xl shadow-lg h-full dark:bg-gray-800/90 dark:border-gray-700"},ze={class:"p-4 max-h-[480px] overflow-y-auto"},Ne={class:"space-y-3"},Fe={class:"flex flex-col"},He={class:"font-bold text-gray-800 dark:text-gray-200"},Qe={class:"text-xs text-blue-700 dark:text-blue-300"},Ee=["onClick"],Ze={key:0,class:"text-center py-6 text-gray-500 text-sm dark:text-gray-400"},Je={class:"flex justify-center text-center mt-8"},Ke=["disabled"],Oe={__name:"[userId]",setup(We){const M=Z(),B=J().params.userId,p=X();U(()=>p.value==="dark");const c=d(!1),n=d("userInfo"),s=d({username:"",email:"",access_level_name:"",first_name:"",last_name:"",gender:"",is_staff:"",is_active:""}),$=d([]),m=d(""),G=d([]),u=d([]),x=d([]),C=d(""),P=d([]),b=d([]),y=d([]),L=d(""),R=U(()=>{if(!C.value)return x.value;const a=C.value.toLowerCase();return x.value.filter(e=>e.name.toLowerCase().includes(a))}),S=U(()=>{if(!L.value)return y.value;const a=L.value.toLowerCase();return y.value.filter(e=>e.name.toLowerCase().includes(a)||e.codename.toLowerCase().includes(a))}),T=async()=>{c.value=!0;try{const[a,e,r,f]=await Promise.all([_.get("accounts/groups-list/"),_.get("accounts/permissions-list/"),_.get(`accounts/user-detail/${B}/`),_.get("accounts/access-level/")]);G.value=a.data,P.value=e.data,$.value=f.data,s.value={username:r.data.username,access_level_name:r.data.access_level_name,email:r.data.email||"",first_name:r.data.first_name||"",last_name:r.data.last_name||"",gender:r.data.gender||"",is_staff:r.data.is_staff,is_active:r.data.is_active},console.log(s.value);const V=r.data.access_level;V&&typeof V=="object"?m.value=V.id||"":m.value=V||"",u.value=r.data.groups||[],b.value=r.data.user_permissions||[],q()}catch{I.fire("خطا","فراخوانی اطلاعات ناموفق بود","error")}finally{c.value=!1}},q=()=>{x.value=G.value.filter(a=>!u.value.some(e=>e.id===a.id)),y.value=P.value.filter(a=>!b.value.some(e=>e.id===a.id))},z=a=>{u.value.push(a),x.value=x.value.filter(e=>e.id!==a.id)},N=a=>{x.value.push(a),u.value=u.value.filter(e=>e.id!==a.id)},F=a=>{b.value.push(a),y.value=y.value.filter(e=>e.id!==a.id)},H=a=>{y.value.push(a),b.value=b.value.filter(e=>e.id!==a.id)},Q=async()=>{try{c.value=!0;const a={email:s.value.email,first_name:s.value.first_name,last_name:s.value.last_name,gender:s.value.gender,is_staff:s.value.is_staff,is_active:s.value.is_active,access_level:m.value||$.id,groups_input:u.value.map(e=>e.id),user_permissions_input:b.value.map(e=>e.id)};console.log(a),await _.patch(`accounts/user-detail/${B}/`,a),await I.fire({icon:"success",title:"انجام شد",text:"اطلاعات کاربر با موفقیت ذخیره شد",timer:2e3,showConfirmButton:!1,background:p.value==="dark"?"#1e1e1e":"#fff",color:p.value==="dark"?"#fff":"#000"}),M.back()}catch(a){await I.fire({icon:"error",title:"انجام نشد",text:`خطایی رخ داده است: ${a}`,timer:2e3,confirmButtonText:"باشه",background:p.value==="dark"?"#1e1e1e":"#fff",color:p.value==="dark"?"#fff":"#000"})}finally{c.value=!1}};return K(T),(a,e)=>(o(),l("div",Y,[t("div",ee,[e[16]||(e[16]=t("h3",{class:"flex items-center text-2xl font-bold text-gray-800 dark:text-gray-100"},[t("span",{class:"text-blue-600 text-3xl mr-3 ml-3"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2.5",stroke:"currentColor",class:"size-7"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})])]),O(" مدیریت گروه‌ها و مجوزهای کاربر ")],-1)),t("button",{onClick:e[0]||(e[0]=r=>W(M).back()),class:"bg-white border border-gray-300 rounded-full px-4 py-2 shadow-sm text-gray-700 hover:bg-gray-850 cursor-pointer transition-colors duration-200 flex items-center dark:bg-gray-800 dark:border-gray-700 dark:text-white"},[...e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})],-1),t("span",{class:"mr-2"},"بازگشت",-1)])])]),c.value?(o(),l("div",te,[...e[17]||(e[17]=[t("div",{class:"animate-spin border-4 border-t-transparent border-blue-500 rounded-full w-12 h-12 mx-auto dark:border-blue-400"},null,-1),t("p",{class:"mt-3 text-gray-600 dark:text-gray-400"},"در حال فراخوانی اطلاعات...",-1)])])):(o(),l("div",re,[t("div",ae,[t("button",{onClick:e[1]||(e[1]=r=>n.value="userInfo"),class:j(["px-6 py-3 font-bold transition-all duration-300 border-b-2 whitespace-nowrap",n.value==="userInfo"?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"])}," اطلاعات کاربر ",2),t("button",{onClick:e[2]||(e[2]=r=>n.value="accessLevel"),class:j(["px-6 py-3 font-bold transition-all duration-300 border-b-2 whitespace-nowrap",n.value==="accessLevel"?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"])}," سطح دسترسی ",2),t("button",{onClick:e[3]||(e[3]=r=>n.value="groups"),class:j(["px-6 py-3 font-bold transition-all duration-300 border-b-2 whitespace-nowrap",n.value==="groups"?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"])}," مدیریت گروه‌ها ",2),t("button",{onClick:e[4]||(e[4]=r=>n.value="permissions"),class:j(["px-6 py-3 font-bold transition-all duration-300 border-b-2 whitespace-nowrap",n.value==="permissions"?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"])}," مدیریت مجوزها ",2)]),n.value==="userInfo"?(o(),l("div",se,[e[27]||(e[27]=t("h4",{class:"text-xl font-bold mb-6 text-gray-800 dark:text-gray-100"},"اطلاعات کاربر",-1)),t("div",le,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-bold mb-2 text-gray-600 dark:text-gray-400"},"نام کاربری",-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>s.value.username=r),type:"text",class:"w-full p-3 border rounded-lg bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white",readonly:"",disabled:""},null,512),[[k,s.value.username]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-bold mb-2 text-gray-600 dark:text-gray-400"},"ایمیل",-1)),i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>s.value.email=r),type:"email",class:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[k,s.value.email]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-bold mb-2 text-gray-600 dark:text-gray-400"},"نام",-1)),i(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>s.value.first_name=r),type:"text",class:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[k,s.value.first_name]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-bold mb-2 text-gray-600 dark:text-gray-400"},"نام خانوادگی",-1)),i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>s.value.last_name=r),type:"text",class:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[k,s.value.last_name]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-bold mb-2 text-gray-600 dark:text-gray-400"},"جنسیت",-1)),i(t("select",{"onUpdate:modelValue":e[9]||(e[9]=r=>s.value.gender=r),class:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[...e[22]||(e[22]=[t("option",{value:""},"انتخاب...",-1),t("option",{value:"male"},"مرد",-1),t("option",{value:"female"},"زن",-1)])],512),[[A,s.value.gender]])]),t("div",oe,[t("div",de,[e[26]||(e[26]=t("label",{class:"block text-sm font-bold mb-2 text-gray-600 dark:text-gray-400"},"وضعیت",-1)),t("div",ne,[t("label",ie,[i(t("input",{"onUpdate:modelValue":e[10]||(e[10]=r=>s.value.is_staff=r),type:"checkbox",class:"w-4 h-4 accent-blue-600"},null,512),[[D,s.value.is_staff]]),e[24]||(e[24]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"ادمین",-1))]),t("label",ue,[i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=r=>s.value.is_active=r),type:"checkbox",class:"w-4 h-4 accent-blue-600"},null,512),[[D,s.value.is_active]]),e[25]||(e[25]=t("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"فعال",-1))])])])])])])):g("",!0),n.value==="accessLevel"?(o(),l("div",be,[e[30]||(e[30]=t("h4",{class:"text-xl font-bold mb-6 text-gray-800 dark:text-gray-100"},"سطح دسترسی",-1)),t("div",ge,[e[29]||(e[29]=t("label",{class:"block text-sm font-bold mb-2 text-gray-600 dark:text-gray-400"},"سطح دسترسی فعلی",-1)),i(t("select",{"onUpdate:modelValue":e[12]||(e[12]=r=>m.value=r),class:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[e[28]||(e[28]=t("option",{value:""},"انتخاب سطح دسترسی...",-1)),(o(!0),l(h,null,w($.value,r=>(o(),l("option",{key:r.id,value:r.id},v(r.level_name),9,ve))),128))],512),[[A,m.value]])])])):g("",!0),n.value==="groups"?(o(),l("div",ce,[t("div",xe,[e[31]||(e[31]=t("div",{class:"bg-blue-50 text-blue-800 font-bold p-4 border-b border-blue-100 rounded-t-2xl dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800"}," گروه‌های دستیافت‌پذیر ",-1)),t("div",ye,[t("div",ke,[i(t("input",{"onUpdate:modelValue":e[13]||(e[13]=r=>C.value=r),type:"text",class:"w-full p-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"جستجوی نام گروه..."},null,512),[[k,C.value]])]),t("div",pe,[t("ul",me,[(o(!0),l(h,null,w(R.value,r=>(o(),l("li",{key:r.id,class:"flex justify-between items-center p-4 rounded-xl border border-gray-200 bg-white hover:bg-gray-50 transition-all duration-200 cursor-pointer dark:bg-gray-700 dark:border-gray-600 dark:hover:bg-gray-600"},[t("span",fe,v(r.name),1),t("button",{onClick:f=>z(r),type:"button",class:"w-9 h-9 rounded-full bg-green-100 text-green-600 hover:bg-green-600 hover:text-white transition-colors duration-200 flex items-center justify-center dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-600 dark:hover:text-white"}," + ",8,he)]))),128)),R.value.length===0?(o(),l("li",we," گروهی یافت نشد ")):g("",!0)])])])]),t("div",_e,[e[32]||(e[32]=t("div",{class:"bg-blue-50 text-blue-800 font-bold p-4 border-b border-blue-100 rounded-t-2xl dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800"}," گروه‌های انتخاب‌شده ",-1)),t("div",Ce,[t("ul",Le,[(o(!0),l(h,null,w(u.value,r=>(o(),l("li",{key:r.id,class:"flex justify-between items-center p-4 rounded-xl border border-blue-200 bg-blue-50 hover:bg-blue-100 transition-all duration-200 cursor-pointer dark:bg-blue-900/20 dark:border-blue-800 dark:hover:bg-blue-900/30"},[t("span",Ve,v(r.name),1),t("button",{onClick:f=>N(r),type:"button",class:"w-9 h-9 rounded-full bg-red-100 text-red-600 hover:bg-red-600 hover:text-white transition-colors duration-200 flex items-center justify-center dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-600 dark:hover:text-white"}," × ",8,je)]))),128)),u.value.length===0?(o(),l("li",$e," کاربر در گروهی نیست ")):g("",!0)])])])])):g("",!0),n.value==="permissions"?(o(),l("div",Ue,[t("div",Ie,[e[33]||(e[33]=t("div",{class:"bg-blue-50 text-blue-800 font-bold p-4 border-b border-blue-100 rounded-t-2xl dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800"}," مجوزهای دستیافت‌پذیر ",-1)),t("div",Me,[t("div",Be,[i(t("input",{"onUpdate:modelValue":e[14]||(e[14]=r=>L.value=r),type:"text",class:"w-full p-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"جستجوی نام یا کد مجوز..."},null,512),[[k,L.value]])]),t("div",Ge,[t("ul",Pe,[(o(!0),l(h,null,w(S.value,r=>(o(),l("li",{key:r.id,class:"flex justify-between items-center p-4 rounded-xl border border-gray-200 bg-white hover:bg-gray-50 transition-all duration-200 cursor-pointer dark:bg-gray-700 dark:border-gray-600 dark:hover:bg-gray-600"},[t("div",Re,[t("span",Se,v(r.name),1),t("code",Ae,v(r.codename),1)]),t("button",{onClick:f=>F(r),type:"button",class:"w-9 h-9 rounded-full bg-green-100 text-green-600 hover:bg-green-600 hover:text-white transition-colors duration-200 flex items-center justify-center dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-600 dark:hover:text-white"}," + ",8,De)]))),128)),S.value.length===0?(o(),l("li",Te," مجوزی یافت نشد ")):g("",!0)])])])]),t("div",qe,[e[34]||(e[34]=t("div",{class:"bg-blue-50 text-blue-800 font-bold p-4 border-b border-blue-100 rounded-t-2xl dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800"}," مجوزهای انتخاب‌شده ",-1)),t("div",ze,[t("ul",Ne,[(o(!0),l(h,null,w(b.value,r=>(o(),l("li",{key:r.id,class:"flex justify-between items-center p-4 rounded-xl border border-blue-200 bg-blue-50 hover:bg-blue-100 transition-all duration-200 cursor-pointer dark:bg-blue-900/20 dark:border-blue-800 dark:hover:bg-blue-900/30"},[t("div",Fe,[t("span",He,v(r.name),1),t("code",Qe,v(r.codename),1)]),t("button",{onClick:f=>H(r),type:"button",class:"w-9 h-9 rounded-full bg-red-100 text-red-600 hover:bg-red-600 hover:text-white transition-colors duration-200 flex items-center justify-center dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-600 dark:hover:text-white"}," × ",8,Ee)]))),128)),b.value.length===0?(o(),l("li",Ze," کاربر فعلاً هیچ مجوز اختصاصی ندارد ")):g("",!0)])])])])):g("",!0),t("div",Je,[t("button",{onClick:Q,disabled:c.value,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white font-bold rounded-full px-8 py-4 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] disabled:opacity-70 disabled:cursor-not-allowed"},v(c.value?"در حال ذخیره...":"ذخیره تغییرات"),9,Ke)])]))]))}},at=E(Oe,[["__scopeId","data-v-5d10873f"]]);export{at as default};
