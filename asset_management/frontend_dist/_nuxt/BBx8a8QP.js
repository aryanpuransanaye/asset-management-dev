import{J as o}from"./BwLa1Iej.js";const c=o("auth",{state:()=>({token:null,userPermissions:[],user:null}),actions:{saveLoginData(s,e,r){this.token=s,this.userPermissions=e,this.user=r,localStorage.setItem("access_token",s)},logout(){this.token=null,this.userPermissions=[],this.user=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}},getters:{isAdmin:s=>s.user?.is_superuser||s.user?.is_staff||s.userPermissions.includes("*"),canSeeAnyAsset:s=>(s.userPermissions,s.userPermissions.some(e=>e.includes("accounts.asset"))||s.user?.is_superuser||s.user?.is_staff||s.userPermissions.includes("*")),canSeeAssets:s=>e=>{if(s.isAdmin)return!0;const r=e,u=s.userPermissions||[];console.log(u);const n=u.includes(`accounts.asset_${r}_r`),i=u.includes(`accounts.asset_${r}_crud`);return console.log(`accounts.asset_${r}_r`),console.log(`accounts.asset_${r}_crud`),n||i},hasPermission:s=>e=>s.userPermissions.includes("*")||s.user?.is_superuser||s.user?.is_staff?!0:s.userPermissions.includes(e)},persist:!0});export{c as u};
